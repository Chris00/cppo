(* comment *)

#include "testdata/incl.cppo"
# 123456
#789 "test"
#include "testdata/incl.cppo"

#define debug(s) Printf.eprintf "%S %i: %s\n%!" __FILE__ __LINE__ s

#define pi 3.14
f(1)
#define f(x) x+pi
f(2)
#undef pi
f(3)

#ifdef g
"g" is defined
#else
"g" is not defined
#endif


#define a(x) b()
#define b(x) a()
a()

debug("a")
debug("b")

#define z 123
#define y z
#define x y

#if x lsl 1 = 2*123

#if 1 = 2
#error "test"
#endif

success
#else
failure
#endif

#define test_multiline \
"abc\
 def" \
(* 123 \
   456 *)
test_multiline

#define test_args(x,y) x y
test_args("a","b")

#define test_argc(x) x y
test_argc(aa\,bb)

#define test_esc(x) x
test_esc(\,\)\()

blah #define xyz
#ifdef xyz
#error "xyz should not have been defined"
#endif

#define sticky1(x) _
#define sticky2(x) sticky1()_ (* the 2 underscores should be space-separated *)
sticky2()

#define empty1
#define empty2 +empty1+ (* there should be some space between the pluses *)
empty2

(* (* nested comment with single single quote: ' *) "*)" *)

#define arg
obj
  \# define arg

'  (* lone single quote *)

#define one 1
oneê is not 1 ê

#undef x
#define x #
x is #

end
